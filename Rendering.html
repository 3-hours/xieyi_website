<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<title>Rendering</title>
	<link rel="stylesheet" type="text/css" href="./css/base.css">
	<link rel="stylesheet" type="text/css" href="./css/common.css">
	<link rel="stylesheet" type="text/css" href="css/rendering.css"/>
	 <!-- Link Swiper's CSS -->
    <link rel="stylesheet" href="./css/swiper.css">

</head>
<body>
	<div id="header">
		<div class="header-nav clearfix">
			<a href="###" class="logo">
				<img src="./img/logo.png">
			</a>
			<div class="show-btn"><span></span><span></span><span></span></div>
			<ul class="nav-bar clearfix">
				<li><a href="index.html">Home</a></li>
				<li><a href="About.html">About</a></li>
				<li class="active"><a href="Rendering.html">Renderings</a></li>
				<li><a href="BIM.html">BIM</a></li>
				<li><a href="3D Animate.html">3D Animate</a></li>
				<li><a href="Contact.html">Contact</a></li>
			</ul>
		</div>
	</div>
	<div id="main">
		<div class="leader">
			<h1>DIGITAL EFFECT DRAWING</h1>
		</div>
	 	<div class="swiper-container">
	        <div class="swiper-wrapper">
	            <div class="swiper-slide"><img src="img/rendering1.jpg"/></div>
	            <div class="swiper-slide"><img src="img/rendering2.jpg"/></div>
	            <div class="swiper-slide"><img src="img/rendering3.jpg"/></div>
	        </div>
	        <!-- Add Pagination -->
        	<div class="swiper-pagination"></div>
    	</div>
   		<div class="waterfall-box">
   			<ul>
   				<li>
   					<!--<div class="pic-box">
   						<img src="img/1.png"/>
   						<div class="mask">
   							<p class="title">
   								标题
   							</p>
   						</div>
   					</div>-->
   				</li>
   				<li>
   					<!--<div class="pic-box">
   						<img src="img/2.png"/>
   						<div class="mask">
   							<p class="title">
   								标题
   							</p>
   						</div>
   					</div>-->
   				</li>
   				<li>
   					<!--<div class="pic-box">
   						<img src="img/3.png"/>
   						<div class="mask">
   							<p class="title">
   								标题
   							</p>
   						</div>
   					</div>-->
   				</li>
   			</ul>
   		</div>
	<div class="triangle">
		<span class="top-word">TOP</span>
	</div>
	</div>
	<div id="footer">
		<div class="concact-box">
			<h2>CONCACT US</h2>
			<div>
				<p>Mobile Phone：86 138 1690 3400</p>
				<p>Email：eric@shining365.com</p>
				<p>tel：+86 21 6598 6866-304  +86 21 6598 3188-304</p>
			</div>
		</div>
		<div class="copyright-bar">
			Copyright © 1998-2015 shining Group
		</div>
	</div>
	<div id="popBox">
		<div>
			<img src="img/1.png">
		</div>
	</div>
	<script type="text/javascript" src="./js/jquery.min.js"></script>
	<script type="text/javascript" src="js/common.js"></script>
	<script src="./js/swiper.js"></script>
	<script type="text/javascript">
		 var swiper = new Swiper('.swiper-container', {
       	 	pagination: '.swiper-pagination',
        	paginationClickable: true
   		 });
			var imgList = document.querySelectorAll("#wrap img");

		$(".triangle").on("click",function(){
		 	$("html,body").animate({
		 		scrollTop:0
		 	},500)
		})
//		$("#wrap li").height($(this).width()/3.52);
//		$(window).on("resize",function(){
//			$("#wrap li").height($(this).width()/3.52);
//		})
		var dataImg = [{
			url:"1.png",
			title:"hello"
		},{
			url:"2.png",
			title:"创意园"
		},{
			url:"3.png",
			title:"科技园区"
		},{
			url:"4.png",
			title:"小区"
		},{
			url:"5.png",
			title:"大厦"
		},{
			url:"6.png",
			title:"软件园"
		},{
			url:"7.png",
			title:"罗雪飞"
		},{
			url:"8.png",
			title:"Shafee"
		},{
			url:"9.png",
			title:"郝存英"
		},{
			url:"10.png",
			title:"Shaying"
		}]
		//var imgSrc = ["1.png","2.png","3.png"];
		var strArr = "123456789";
		//array.map 返回来的也是数组
		var imgSrc = strArr.split("").map(function(key, index) {
			return  key + ".png"
		})
//		dataImg.forEach(function(key, index) {
//			var newBox = $("<div/>", {
//				class: "pic-box"
//			})
//			var html = '<img src="img/'+ key.url +'">'+
// 						'<div class="mask">'+
// 							'<p class="title">'+ key.title +'</p>'+
// 						'</div>';
// 			newBox.html(html);
// 			$(".waterfall-box li").eq(0).append(newBox);
//		})
		var lists = $(".waterfall-box li");
			var len = dataImg.length;
			var count = 0;
			// 图片预加载
			for(var k = 0; k < len; k++) {
				var img = new Image();
				img.src = "img/" + dataImg[k].url;
				img.onload = function() {
					count++;
					if(count === len) {
						waterfall();
					}
				}
			}

			function waterfall() {
				for(var i = 0; i < len; i++ ) {
					var newBox = $("<div />", {
						class: "pic-box"
					})
					var html = '<img src="img/'+ dataImg[i].url +'">\
								<div class="mask">\
									<p class="title">'+ dataImg[i].title +'</p>\
								</div>';
					newBox.html(html);

					var minList = lists.eq(0);
					for(var j = 0; j < lists.length; j++) {
						if(minList.height() > lists.eq(j).height()) {
							minList = lists.eq(j);
						}
					}
					// console.log(minList.index())
					minList.append(newBox);
				}
			}	


			// 到底底部，重新请求数据
			$(window).on("scroll", function() {
				if($("#footer").get(0).getBoundingClientRect().top < window.innerHeight-300) {
					waterfall();
				} 
			})

			// 点击显示蒙层图片
			$(".waterfall-box").on("click", ".pic-box", function() {
				$("#popBox img").attr("src", $(this).find("img").attr("src"))
				$("#popBox").show();
				// 弹窗居中
				$("#popBox div").css({
					left: (window.innerWidth - $("#popBox div").outerWidth())/2,
					top: (window.innerHeight - $("#popBox div").outerHeight())/2,

				})
			})
			$("#popBox div").on("click", function(e) {
				e.stopPropagation();
			})
			$("#popBox").on("click", function() {
				$(this).hide();
			})
	</script>
</body>
</html>